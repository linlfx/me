12 跟踪和调试VoIP
====================================================

解决问题是FreeSWITCH和VoIP很重要的一部分。有许多组件都在你的控制之外，所以你需要熟悉调试失败的呼叫。

通常当你使用不同电话组件时你有一个混杂的LAN网络，你的FreeSWITCH服务器，你的网络电话提供商，DID电话提供商等。另外，你有防火墙、路由器、ADSL、其他数字中继，你通常只能直接控制你的FreeSWITCH。

这一章将给你第一个大的画面，它如何工作，为什么会中断，然后将介绍最好的工具用来检修VoIP。

FreeSWITCH是非常可靠的、可预测的和文档全面的，但VoIP的生态系统有许多不明确的领域。

为了能全面理解问题，建议部署一个VoIP用于？？？？？（VoIP Deployment for Dummies）反正是一本有400页的书，将给你完整的通识课程（包括SIP、LAN测试，ITSP的处理，以及其他）。

这里将包括以下内容：

信令和媒体；
为什么中断；
网络跟踪、捕获和分析工具；
语音分析和操作工具；

——————————————————————————————————————————
什么情况下会出错
——————————————————————————————————————————

在通讯中有两种数据流：信令和媒体。它们通常对于呼叫者和被呼叫者是完全无关的，它们的IP包通过不同的网关和路由传输，同时，它们也是通过不同的软件和协议来管理（或者是同一个应用的不同部分）。信令和媒体互相之间不做任何交互，其中一个的正常工作或失败都与另一个流无关，但你需要保证它们都正确工作，以使你的用户有一个完整的通讯会话。

信令是信息流，用于定义谁呼叫谁，以什么路径通话，使用什么技术实现内容传输。在通讯中最常用的信令协议是SIP，它定义了呼出者的IP和端口，接听者的IP和端口，以及所有传输信令时参与的中介的IP和端口，它也定义在呼叫中的许多阶段（开始、震铃、挂断、忙，等等）。SIP使用SDP（作为SIP包的一部分传输）来定义内容（音频、视频、文件、桌面共享、等等），使用的编码，媒体服务器的IP和端口，为每一个通讯方向都做以上定义（呼出者到接听者，接听者到呼出者）。你可以把SDP当成SIP的一部分，尽管它们在技术上是不同的协议。

媒体完全使用RTP协议传输，基于在SIP中定义的SDP路径。RTP包基本上都是语音和视频流的二进制加密采样。

所以，我们最少需要4个流通道（从呼出到接听的信令流和媒体流，从接听到呼出的信令流和媒体 流）
